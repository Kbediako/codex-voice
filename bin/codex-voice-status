#!/data/data/com.termux/files/usr/bin/sh

VOICE_DIR="$HOME/.codex/device"
PID_FILE="$VOICE_DIR/voice.pid"

if pgrep -f "/codex-voice" >/dev/null 2>&1; then
  termux-toast "Codex voice running" >/dev/null 2>&1 || true
  exit 0
fi

if [ -f "$PID_FILE" ]; then
  pid=$(cat "$PID_FILE" 2>/dev/null)
  if [ -n "$pid" ] && kill -0 "$pid" 2>/dev/null; then
    termux-toast "Codex voice running (pid $pid)" >/dev/null 2>&1 || true
    exit 0
  fi
fi

termux-toast "Codex voice is stopped" >/dev/null 2>&1 || true
